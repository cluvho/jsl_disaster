<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">
<div layout:fragment="content">
    <div class="page-detail">
        <div class="main-content">
            <main class="content-area">
                <div class="region-header">
                    <div class="region-header-top">
                        <h1>🏙️ <span id="regionName" data-translate="region_daejeon">대전광역시</span></h1>
                        <div class="region-search">
                            <input type="text" id="regionSearchInput" data-translate-placeholder="search_placeholder" placeholder="지역명을 입력하세요" />
                            <button onclick="searchRegion()">🔍 <span data-translate="search_btn">검색</span></button>
                        </div>
                    </div>
                    <p data-translate="header_description">リアルタイムで災害安全情報と対応状況を確認してください。</p>
                </div>

                <div class="navigation-bar">
                    <div class="nav-menu">
                        <a href="#weather-section" class="nav-item" onclick="scrollToSection('weather-section', this)">
                            🌤️ <span data-translate="nav_weather">天気予報</span>
                        </a>
                        <a href="#disaster-section" class="nav-item" onclick="scrollToSection('disaster-section', this)">
                            🚨 <span data-translate="nav_disaster">災害情報</span>
                        </a>
                        <a href="#facility-section" class="nav-item" onclick="scrollToSection('facility-section', this)">
                            🏥 <span data-translate="nav_facility">施設情報</span>
                        </a>
                        <a href="#history-section" class="nav-item" onclick="scrollToSection('history-section', this)">
                            📊 <span data-translate="nav_history">災害履歴</span>
                        </a>
                        <a href="#news-section" class="nav-item" onclick="scrollToSection('news-section', this)">
                            📰 <span data-translate="nav_news">関連ニュース</span>
                        </a>
                    </div>
                </div>

                <div id="weather-section" class="section">
                    <h2 class="section-title">🌤️ <span data-translate="weather_title">天気予報</span></h2>
                    
                    <div class="weather-overview">
                        <div class="weather-card">
                            <div class="icon">☀️</div>
                            <div class="temp" id="currentTemp">ローディング中。。</div>
                            <div class="desc" id="currentWeather" data-translate="weather_sunny">晴れ</div>
                        </div>
                    </div>

                    <div class="weather-details">
                        <div class="weather-detail-item">
                            <div class="label" data-translate="wind_speed">風</div>
                            <div class="value">...</div>
                        </div>
                        <div class="weather-detail-item">
                            <div class="label" data-translate="humidity">湿度</div>
                            <div class="value">...</div>
                        </div>
                        <div class="weather-detail-item">
                            <div class="label" data-translate="uv_index">紫外線</div>
                            <div class="value">...</div>
                        </div>
                    </div>

                    <div class="forecast-tabs">
                        <div class="forecast-tab active" onclick="showForecast('hourly', this)">
                            <span data-translate="hourly_forecast">本日</span>
                        </div>
                        <div class="forecast-tab" onclick="showForecast('daily', this)">
                            <span data-translate="daily_forecast">週間</span>
                        </div>
                        <div class="forecast-tab" onclick="showForecast('warning', this)">
                            <span data-translate="weather_warning">特報</span>
                        </div>
                    </div>

                    <div id="hourly" class="forecast-content active">
                        <div class="hourly-forecast">
                            <!-- 동적으로 생성됨 -->
                        </div>
                    </div>

                    <div id="daily" class="forecast-content">
                        <div class="daily-forecast">
                            <!-- 동적으로 생성됨 -->
                        </div>
                    </div>

                    <div id="warning" class="forecast-content">
                        <!-- 동적으로 생성됨 -->
                    </div>
                </div>

                <div id="disaster-section" class="section">
                    <h2 class="section-title">🚨 <span data-translate="disaster_title">災害情報</span></h2>
                    
                    <!-- 실시간 JMA 재해 정보 표시 영역 -->
                    <div class="realtime-disaster-info" style="background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                        <h3>🔴リアルタイム災害情報</h3>
                        <div id="disaster-status" style="font-weight: bold; color: #666; margin-bottom: 10px;">ロード中…</div>
                        <div id="last-update" style="font-size: 0.9em; color: #888; margin-bottom: 15px;">最終更新: -</div>
                        
                        <!-- 지진 정보 -->
                        <div class="earthquake-section" style="margin-bottom: 20px;">
                            <h4>🌋地震情報</h4>
                            <div id="earthquake-list" style="background: white; padding: 15px; border-radius: 5px; border-left: 4px solid #dc3545;">-</div>
                        </div>
                        
                        <!-- 화산 정보 -->
                        <div class="volcano-section">
                            <h4>🗻火山情報</h4>
                            <div id="volcano-list" style="background: white; padding: 15px; border-radius: 5px; border-left: 4px solid #fd7e14;">-</div>
                        </div>
                    </div>
                    
                    <div class="disaster-alert">
                        <div class="alert-level">⚠️ <span data-translate="alert_caution">注意段階</span></div>
                        <h3 data-translate="current_alert_status">現在災害の状態</h3>
                        <p id="alert-desc">お知らせを取得しています…</p>
                    </div>

                    <div class="disaster-list" id="disaster-list">
                        <!-- 동적으로 생성됨 -->
                    </div>
                </div>

                <div id="facility-section" class="section">
                    <h2 class="section-title">🏥 <span data-translate="facility_title">施設情報</span></h2>
                    
                    <div class="facility-tabs">
                        <div class="facility-tab active" onclick="showFacility('shelter', this)">
                            <span data-translate="shelter">避難所</span>
                        </div>
                        <div class="facility-tab" onclick="showFacility('hospital', this)">
                            <span data-translate="hospital">病院</span>
                        </div>
                    </div>

                    <div id="shelter" class="facility-content active">
                        <div class="facility-list">
                            <!-- 동적으로 생성됨 -->
                        </div>
                    </div>

                    <div id="hospital" class="facility-content">
                        <div class="facility-list">
                            <!-- 동적으로 생성됨 -->
                        </div>
                    </div>
                </div>

                <div id="history-section" class="section">
                    <h2 class="section-title">📊 <span data-translate="history_title">災害履歴</span></h2>
                    
                    <!-- DB에서 가져온 실제 재난 이력 표시 영역 -->
                    <div class="db-history-section" style="background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                        <h3>📈 災害履歴</h3>
                        <div id="db-history-status" style="font-weight: bold; color: #666; margin-bottom: 10px;">ロード中</div>
                        <div id="db-history-list" style="background: white; padding: 15px; border-radius: 5px;">
                            <!-- DB 데이터가 여기에 표시됩니다 -->
                        </div>
                    </div>
                    
                    <!-- 기존 정적 데이터 (샘플로 유지) -->
                    <h3>📋サンプル災害情報</h3>
                    <div class="history-list">
                        <div class="history-item">
						    <div class="history-header">
						        <div class="history-title">🌊 <span data-translate="flood_2024">2024年 東京豪雨による被害</span></div>
						        <div class="history-date">2024.07.15</div>
						    </div>
						    <div class="history-content" data-translate="flood_2024_desc">
						        時間当たり80ミリの集中豪雨により、東京都杉並区一帯で浸水被害が発生。  
						        約50名の住民が避難し、30台の車両が水没。  
						        迅速な避難所運営により人的被害は最小限に抑えられた。
						    </div>
						</div>
                        
                     

                    </div>
                </div>

                <div id="news-section" class="section">
                    <h2 class="section-title">📰 <span data-translate="news_title">関連ニュース</span></h2>
                    
                    <div class="news-list">
                        <!-- 동적으로 생성됨 -->
                    </div>
                </div>
            </main>
        </div>
    </div>
</div>

<th:block layout:fragment="script">
    <!-- 사용자 위치 정보 전달 -->
    <script th:inline="javascript">
        window.USER_LOCATION = {
            address: /*[[${userAddress}]]*/ '東京',
            latitude: /*[[${userLatitude}]]*/ 35.6895,
            longitude: /*[[${userLongitude}]]*/ 139.6917
        };
        console.log('사용자 위치 정보:', window.USER_LOCATION);
    </script>
    
    <!-- Google Maps API -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBdiJWNOl98gTR6XjCfDhubMwXQZVO3ejs&libraries=places&v=weekly" async defer></script>
    
    <!-- 통합 jma.js 파일만 로드 -->
    <script src="/js/detail/jma.js"></script>
</th:block>

</body>
</html>