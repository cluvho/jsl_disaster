<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">
<div layout:fragment="content">
    <div class="page-detail">
        <div class="main-content">
            <main class="content-area">
                <div class="region-header">
                    <div class="region-header-top">
                        <h1>🏙️ <span id="regionName" data-translate="region_daejeon">대전광역시</span></h1>
                        <div class="region-search">
                            <input type="text" id="regionSearchInput" data-translate-placeholder="search_placeholder" placeholder="지역명을 입력하세요" />
                            <button onclick="searchRegion()">🔍 <span data-translate="search_btn">검색</span></button>
                        </div>
                    </div>
                    <p data-translate="header_description">실시간 재난 안전 정보 및 대응 현황을 확인하세요</p>
                </div>

                <div class="navigation-bar">
                    <div class="nav-menu">
                        <a href="#weather-section" class="nav-item" onclick="scrollToSection('weather-section', this)">
                            🌤️ <span data-translate="nav_weather">날씨 정보</span>
                        </a>
                        <a href="#disaster-section" class="nav-item" onclick="scrollToSection('disaster-section', this)">
                            🚨 <span data-translate="nav_disaster">재난 정보</span>
                        </a>
                        <a href="#facility-section" class="nav-item" onclick="scrollToSection('facility-section', this)">
                            🏥 <span data-translate="nav_facility">시설 정보</span>
                        </a>
                        <a href="#history-section" class="nav-item" onclick="scrollToSection('history-section', this)">
                            📊 <span data-translate="nav_history">재난 이력</span>
                        </a>
                        <a href="#news-section" class="nav-item" onclick="scrollToSection('news-section', this)">
                            📰 <span data-translate="nav_news">관련 뉴스</span>
                        </a>
                    </div>
                </div>

                <div id="weather-section" class="section">
                    <h2 class="section-title">🌤️ <span data-translate="weather_title">날씨 정보</span></h2>
                    
                    <div class="weather-overview">
                        <div class="weather-card">
                            <div class="icon">☀️</div>
                            <div class="temp" id="currentTemp">로딩중...</div>
                            <div class="desc" id="currentWeather" data-translate="weather_sunny">맑음</div>
                        </div>
                    </div>

                    <div class="weather-details">
                        <div class="weather-detail-item">
                            <div class="label" data-translate="wind_speed">바람</div>
                            <div class="value">...</div>
                        </div>
                        <div class="weather-detail-item">
                            <div class="label" data-translate="humidity">습도</div>
                            <div class="value">...</div>
                        </div>
                        <div class="weather-detail-item">
                            <div class="label" data-translate="uv_index">자외선</div>
                            <div class="value">...</div>
                        </div>
                    </div>

                    <div class="forecast-tabs">
                        <div class="forecast-tab active" onclick="showForecast('hourly', this)">
                            <span data-translate="hourly_forecast">오늘 예보</span>
                        </div>
                        <div class="forecast-tab" onclick="showForecast('daily', this)">
                            <span data-translate="daily_forecast">주간 예보</span>
                        </div>
                        <div class="forecast-tab" onclick="showForecast('warning', this)">
                            <span data-translate="weather_warning">기상 특보</span>
                        </div>
                    </div>

                    <div id="hourly" class="forecast-content active">
                        <div class="hourly-forecast">
                            <!-- 동적으로 생성됨 -->
                        </div>
                    </div>

                    <div id="daily" class="forecast-content">
                        <div class="daily-forecast">
                            <!-- 동적으로 생성됨 -->
                        </div>
                    </div>

                    <div id="warning" class="forecast-content">
                        <!-- 동적으로 생성됨 -->
                    </div>
                </div>

                <div id="disaster-section" class="section">
                    <h2 class="section-title">🚨 <span data-translate="disaster_title">재난 정보</span></h2>
                    
                    <!-- 실시간 JMA 재해 정보 표시 영역 -->
                    <div class="realtime-disaster-info" style="background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                        <h3>🔴 실시간 일본 재해 정보</h3>
                        <div id="disaster-status" style="font-weight: bold; color: #666; margin-bottom: 10px;">데이터 로딩 중...</div>
                        <div id="last-update" style="font-size: 0.9em; color: #888; margin-bottom: 15px;">마지막 업데이트: -</div>
                        
                        <!-- 지진 정보 -->
                        <div class="earthquake-section" style="margin-bottom: 20px;">
                            <h4>🌋 지진 정보</h4>
                            <div id="earthquake-list" style="background: white; padding: 15px; border-radius: 5px; border-left: 4px solid #dc3545;">-</div>
                        </div>
                        
                        <!-- 화산 정보 -->
                        <div class="volcano-section">
                            <h4>🗻 화산 정보</h4>
                            <div id="volcano-list" style="background: white; padding: 15px; border-radius: 5px; border-left: 4px solid #fd7e14;">-</div>
                        </div>
                    </div>
                    
                    <div class="disaster-alert">
                        <div class="alert-level">⚠️ <span data-translate="alert_caution">주의 단계</span></div>
                        <h3 data-translate="current_alert_status">현재 재난 알림 상태</h3>
                        <p id="alert-desc">알림 정보를 불러오는 중...</p>
                    </div>

                    <div class="disaster-list" id="disaster-list">
                        <!-- 동적으로 생성됨 -->
                    </div>
                </div>

                <div id="facility-section" class="section">
                    <h2 class="section-title">🏥 <span data-translate="facility_title">시설 정보</span></h2>
                    
                    <div class="facility-tabs">
                        <div class="facility-tab active" onclick="showFacility('shelter', this)">
                            <span data-translate="shelter">대피소</span>
                        </div>
                        <div class="facility-tab" onclick="showFacility('hospital', this)">
                            <span data-translate="hospital">병원</span>
                        </div>
                    </div>

                    <div id="shelter" class="facility-content active">
                        <div class="facility-list">
                            <!-- 동적으로 생성됨 -->
                        </div>
                    </div>

                    <div id="hospital" class="facility-content">
                        <div class="facility-list">
                            <!-- 동적으로 생성됨 -->
                        </div>
                    </div>
                </div>

                <div id="history-section" class="section">
                    <h2 class="section-title">📊 <span data-translate="history_title">과거 재난 이력</span></h2>
                    
                    <!-- DB에서 가져온 실제 재난 이력 표시 영역 -->
                    <div class="db-history-section" style="background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                        <h3>📈 실제 재난 이력 (DB)</h3>
                        <div id="db-history-status" style="font-weight: bold; color: #666; margin-bottom: 10px;">데이터 로딩 중...</div>
                        <div id="db-history-list" style="background: white; padding: 15px; border-radius: 5px;">
                            <!-- DB 데이터가 여기에 표시됩니다 -->
                        </div>
                    </div>
                    
                    <!-- 기존 정적 데이터 (샘플로 유지) -->
                    <h3>📋 샘플 재난 이력</h3>
                    <div class="history-list">
                        <div class="history-item">
                            <div class="history-header">
                                <div class="history-title">🌊 <span data-translate="flood_2024">2024년 집중호우 피해</span></div>
                                <div class="history-date">2024.07.15</div>
                            </div>
                            <div class="history-content" data-translate="flood_2024_desc">
                                시간당 80mm의 집중호우로 서구 둔산동 일대 침수 피해 발생. 
                                이재민 50여 명 발생, 차량 침수 30대. 
                                신속한 대피소 운영으로 인명피해 최소화.
                            </div>
                        </div>
                        
                        <div class="history-item">
                            <div class="history-header">
                                <div class="history-title">💨 <span data-translate="typhoon_2023">2023년 태풍 힌남노</span></div>
                                <div class="history-date">2023.09.05</div>
                            </div>
                            <div class="history-content" data-translate="typhoon_2023_desc">
                                태풍 힌남노 영향으로 최대풍속 25m/s 강풍. 
                                가로수 넘어짐 15건, 정전 3시간 지속. 
                                사전 대피 조치로 인명피해 없음.
                            </div>
                        </div>

                        <div class="history-item">
                            <div class="history-header">
                                <div class="history-title">🔥 <span data-translate="fire_2022">2022년 산불 발생</span></div>
                                <div class="history-date">2022.04.08</div>
                            </div>
                            <div class="history-content" data-translate="fire_2022_desc">
                                동구 산림지역 소규모 산불 발생. 
                                산림 5ha 소실, 2시간 만에 완전 진화. 
                                주민 대피 없이 신속 대응 완료.
                            </div>
                        </div>
                    </div>
                </div>

                <div id="news-section" class="section">
                    <h2 class="section-title">📰 <span data-translate="news_title">관련 뉴스</span></h2>
                    
                    <div class="news-list">
                        <!-- 동적으로 생성됨 -->
                    </div>
                </div>
            </main>
        </div>
    </div>
</div>

<th:block layout:fragment="script">
    <!-- 사용자 위치 정보 전달 -->
    <script th:inline="javascript">
        window.USER_LOCATION = {
            address: /*[[${userAddress}]]*/ '東京',
            latitude: /*[[${userLatitude}]]*/ 35.6895,
            longitude: /*[[${userLongitude}]]*/ 139.6917
        };
        console.log('사용자 위치 정보:', window.USER_LOCATION);
    </script>
    
    <!-- Google Maps API -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBdiJWNOl98gTR6XjCfDhubMwXQZVO3ejs&libraries=places&v=weekly" async defer></script>
    
    <!-- 통합 jma.js 파일만 로드 -->
    <script src="/js/detail/jma.js"></script>
</th:block>

</body>
</html>