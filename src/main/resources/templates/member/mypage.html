	<!DOCTYPE html>
	<html xmlns:th="http://www.thymeleaf.org"
	      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	      layout:decorate="~{layout/layout}">
	<head>
	    <style>
	        @charset "UTF-8";
	
	        :root {
	            --main-red: #E60012;
	            --bg-color: #F5F6F8;
	            --text-color: #222222;
	            --subtle-text-color: #666666;
	            --border-color: #EAEAEA;
	            --white-color: #FFFFFF;
	        }
	
	        html, body {
	            height: 100%;
	            margin: 0;
	            padding: 0;
	            font-family: 'Noto Sans KR', sans-serif;
	            background-color: var(--bg-color);
	            color: var(--text-color);
	        }
	
	        .page-wrapper {
	            display: flex;
	            flex-direction: column;
	            height: 100%;
	        }
	
	        /* --- 헤더 --- */
	        .header {
	            display: flex;
	            justify-content: space-between;
	            align-items: center;
	            padding: 0 30px;
	            background-color: var(--white-color);
	            border-bottom: 1px solid var(--border-color);
	            flex-shrink: 0;
	            height: 64px;
	            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
	            position: relative;
	            z-index: 10;
	        }
	
	        .header .logo a {
	            font-size: 20px;
	            font-weight: 700;
	            color: var(--main-red);
	            text-decoration: none;
	        }
	
	        .header nav {
	            display: flex;
	            gap: 25px;
	        }
	
	        .header nav a {
	            font-size: 16px;
	            font-weight: 500;
	            color: var(--subtle-text-color);
	            text-decoration: none;
	            padding: 20px 5px;
	            border-bottom: 2px solid transparent;
	            transition: color 0.2s, border-color 0.2s;
	        }
	
	        .header nav a.active, .header nav a:hover {
	            color: var(--text-color);
	            border-bottom: 2px solid var(--main-red);
	        }
	
	        .header .user-options {
	            display: flex;
	            align-items: center;
	            gap: 15px;
	        }
	
	        .header .user-options a {
	            font-size: 14px;
	            color: var(--subtle-text-color);
	            text-decoration: none;
	        }
	
	        .header .user-options a:hover {
	            color: var(--main-red);
	        }
	
	        /* --- 메인 컨텐츠 영역 --- */
	        .main-content {
	            display: flex;
	            flex-grow: 1;
	            overflow: hidden;
	        }
	
	        /* --- 사이드바 --- */
	        .sidebar {
	            width: 300px;
	            background-color: var(--white-color);
	            border-right: 1px solid var(--border-color);
	            flex-shrink: 0;
	            padding: 25px;
	            overflow-y: auto;
	        }
	
	        .sidebar-title {
	            font-size: 20px;
	            font-weight: 700;
	            padding-bottom: 15px;
	            border-bottom: 2px solid var(--main-red);
	            margin: 0 0 25px 0;
	        }
	
	        .filter-group label {
	            display: flex;
	            align-items: center;
	            font-size: 16px;
	            cursor: pointer;
	            margin-bottom: 18px;
	        }
	
	        .filter-group input[type="checkbox"] {
	            margin-right: 12px;
	            width: 18px;
	            height: 18px;
	            accent-color: var(--main-red);
	        }
	
	        /* --- 본문 (지도 + 카드) --- */
	        .content-area {
	            flex-grow: 1;
	            padding: 30px;
	            overflow-y: auto;
	        }
	
	        .section-title {
	            font-size: 20px;
	            font-weight: 700;
	            padding-bottom: 10px;
	            border-bottom: 2px solid var(--main-red);
	            margin-bottom: 20px;
	        }
	
	        /* --- 카드 리스트 스타일 --- */
	        .card-list a {
	            display: flex;
	            align-items: center;
	            background-color: var(--white-color);
	            padding: 20px 15px;
	            border: 1px solid var(--border-color);
	            border-radius: 8px;
	            margin-bottom: 15px;
	            text-decoration: none;
	            color: var(--text-color);
	            transition: box-shadow 0.2s ease, transform 0.2s ease;
	        }
	
	        .card-list a:hover {
	            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
	            transform: translateY(-2px);
	        }
	
	        .card-content h4 {
	            margin: 0 0 5px;
	            font-size: 18px;
	            font-weight: 700;
	        }
	
	        .card-content p {
	            margin: 0;
	            font-size: 14px;
	            color: var(--subtle-text-color);
	        }
	
	        /* --- 푸터 --- */
	        .footer {
	            background-color: #343A40;
	            color: #ADB5BD;
	            padding: 20px 30px;
	            font-size: 14px;
	            display: flex;
	            justify-content: space-between;
	            align-items: center;
	            flex-shrink: 0;
	            border-top: 1px solid #495057;
	        }
	
	        .footer a {
	            color: #ADB5BD;
	            text-decoration: none;
	            margin-right: 20px;
	        }
	
	        .footer a:hover {
	            color: var(--white-color);
	        }
	
	        .footer .emergency-contacts span {
	            margin-left: 15px;
	            font-weight: 500;
	            color: #F8F9FA;
	        }
	
	        /* --- 마이 페이지 관련 --- */
	        body {
	            font-family: "Noto Sans KR", sans-serif;
	            background-color: #f4f6f9;
	            margin: 0;
	            padding: 0;
	        }
	
	        .content-area {
	            padding: 20px;
	        }
	
	        .section-title {
	            font-size: 20px;
	            font-weight: bold;
	            margin: 30px 0 15px;
	            color: #333;
	            border-left: 4px solid #007bff;
	            padding-left: 10px;
	        }
	
	        .card button {
	            display: block;
	            margin: 10px auto;
	        }
	
	        .card-list > button {
	            display: block;
	            margin: 15px auto;
	        }
	
	        .profile-settings {
	            display: flex;
	            gap: 20px;
	            flex-wrap: wrap;
	        }
	
	        .card-section {
	            flex: 1;
	            min-width: 200px;
	        }
	
	        .card-list {
	            margin-bottom: 25px;
	        }
	
	        .card {
	            background: #fff;
	            border-radius: 12px;
	            box-shadow: 0 2px 6px rgba(0,0,0,0.08);
	            padding: 20px;
	            margin-bottom: 15px;
	        }
	
	        label {
	            display: block;
	            margin: 10px 0;
	            font-size: 14px;
	            color: #444;
	        }
	
	        input[type="text"], input[type="password"] {
	            width: 280px;
	            padding: 8px;
	            margin-left: 8px;
	            border: 1px solid #ccc;
	            border-radius: 6px;
	        }
	
	        button {
	            margin-top: 12px;
	            padding: 10px 18px;
	            background: #007bff;
	            color: #fff;
	            font-weight: bold;
	            border: none;
	            border-radius: 6px;
	            cursor: pointer;
	            transition: background 0.2s ease;
	        }
	
	        button:hover {
	            background: #0056b3;
	        }
	
	        table {
	            width: 100%;
	            border-collapse: collapse;
	            margin-top: 12px;
	        }
	
	        th, td {
	            border: 1px solid #e0e0e0;
	            padding: 10px;
	            font-size: 14px;
	        }
	
	        th {
	            background: #f1f3f6;
	            text-align: center;
	        }
	
	        td {
	            background: #fff;
	        }
	
	        ul {
	            padding: 0;
	            margin: 0;
	            list-style: none;
	        }
	
	        ul li {
	            margin: 6px 0;
	        }
	        
	        
	        
	           .line-login-button {
	            display: inline-block;
	            padding: 8px 15px;
	            background-color: #00C300;
	            color: white;
	            text-decoration: none;
	            border-radius: 6px;
	            font-weight: bold;
	            margin-left: 8px;
	            transition: background-color 0.2s;
	        }
	        .line-login-button:hover {
	            background-color: #00A900;
	        }
	        .line-linked-message {
	            margin-left: 8px;
	            color: var(--subtle-text-color);
	            font-weight: bold;
	        }
	        
	    </style>
	</head>
	<div layout:fragment="content">
	    <div class="page-wrapper">
	        <div class="main-content">
	            <main class="content-area">
	                <!-- 프로필 관리 -->
	                <h2 class="section-title">
	                    <i class="fa-regular fa-user"></i>・프로필 관리
	                </h2>
	                <div class="card-list">
	                    <form th:action="@{/member/updateProfile}" method="post">
	                        <div class="card" th:object="${member}">
	                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
	                            <label>성　 함 : <input type="text" name="name" th:value="*{name}"></label>
	                            <label>닉 네 임 : <input type="text" name="nickname" th:value="*{nickname}"></label>
	                            <label>이 메 일 : <input type="text" th:value="*{email}" readonly style="background-color: #eee;"></label>
	                            <hr style="margin: 20px 0;">
	                            <label>현재 비밀번호 : <input type="password" name="currentPassword" placeholder="변경 시 현재 비밀번호 입력"></label>
	                            <label>새 비밀번호 : <input type="password" name="newPassword" placeholder="8자 이상 입력"></label>
	                            <label>새 비밀번호 확인 : <input type="password" name="newPasswordConfirm" placeholder="새 비밀번호 다시 입력"></label>
	                            <hr style="margin: 20px 0;">
	                            <div th:object="${address}">
	                                <label>우편번호 : <input type="text" name="postalCode" th:value="*{postalCode}"></label>
	                                <label>주 소 : <input type="text" name="addrLine1" th:value="*{addrLine1}" ></label>
	                                <label>상세 주소 : <input type="text" name="addrLine2" th:value="*{addrLine2}"></label>
	                            </div>
	                            <label>연 락 처 : <input type="text" name="phone" th:value="*{phone}"></label>
	                           <label>L I N E :
	                                <!-- member 객체에 lineUserId가 없으면 '연동하기' 버튼 표시 -->
	                                <span th:if="*{lineUserId == null}">
	                                    <a href="/line/login" class="line-login-button">LINE 연동하기</a>
	                                </span>
	                                <!-- lineUserId가 있으면 '연동 완료' 메시지 표시 -->
	                                <span th:unless="*{lineUserId == null}" class="line-linked-message">
	                                    연동 완료 ✅
	                                </span>
	                            </label>
	                            <button type="submit">정보 수정</button>
	                        </div>
	                    </form>
	                </div>
	
	
	
	<!-- 알림 수신 방법 -->
                <h2 class="section-title">
                    <i class="fa-regular fa-envelope"></i>・알림 수신 방법
                </h2>
                <div class="card-list">
                     <form th:action="@{/member/update-notification-settings}" method="post">
        <!-- [수정] CSRF 토큰을 여기에 추가했습니다. -->
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        
        <div class="card" th:object="${member}">
            <label style="font-size: 16px; cursor: pointer;">
                <input type="checkbox" th:field="*{notifyLine}" style="width: 20px; height: 20px; vertical-align: middle; margin-right: 10px;"/>
                LINE 재난 알림 받기
            </label>
            <p style="color: #666; font-size: 14px; margin-top: 10px; padding-left: 30px;">
                LINE 계정이 연동된 경우, 거주 지역의 재난 정보를 실시간으로 받아보실 수 있습니다.
            </p>
            <button type="submit">설정 저장</button>
        </div>
    </form>
                </div>
	                
	                
	                
	                
	                <!-- 내 활동 내역 -->
	                <h2 class="section-title">
	                    <i class="fa-regular fa-rectangle-list"></i>・내 활동 내역
	                </h2>
	                <div class="card-list">
	                    <div class="card">
	                        <h3>・작성한 글</h3>
	                        <div th:if="${!#lists.isEmpty(myPosts)}">
	                            <table>
	                                <thead>
	                                <tr>
	                                    <th>제목</th>
	                                    <th>작성일</th>
	                                </tr>
	                                </thead>
	                                <tbody>
	                                <tr th:each="post : ${myPosts}">
	                                    <td>
	                                        <a th:href="@{/community/{id}(id=${post.postId})}" th:text="${post.title}">게시글 제목</a>
	                                    </td>
	                                    <td th:text="${#temporals.format(post.createdAt, 'yyyy-MM-dd')}">2025-09-01</td>
	                                </tr>
	                                </tbody>
	                            </table>
	                        </div>
	                        <div th:unless="${!#lists.isEmpty(myPosts)}">
	                            <p style="text-align: center; color: #888; padding: 20px 0;">작성한 글이 없습니다.</p>
	                        </div>
	                    </div>
	
	                    <div class="card">
	                        <h3>・댓글 단 글</h3>
	                        <div th:if="${!#lists.isEmpty(commentedPosts)}">
	                            <table>
	                                <thead>
	                                <tr>
	                                    <th>게시글 제목</th>
	                                    <th>내 댓글</th>
	                                    <th>게시글 작성일</th>
	                                </tr>
	                                </thead>
	                                <tbody>
	                                <tr th:each="post : ${commentedPosts}">
	                                    <td>
	                                        <a th:href="@{/community/{id}(id=${post.postId})}" th:text="${post.title}">재난 대피소 위치 공유</a>
	                                    </td>
	                                    <td>
	                                        <a th:href="@{/community/{id}(id=${post.postId})}">댓글 확인</a>
	                                    </td>
	                                    <td th:text="${#temporals.format(post.createdAt, 'yyyy-MM-dd')}">2025-08-28</td>
	                                </tr>
	                                </tbody>
	                            </table>
	                        </div>
	                        <div th:unless="${!#lists.isEmpty(commentedPosts)}">
	                            <p style="text-align: center; color: #888; padding: 20px 0;">댓글을 작성한 글이 없습니다.</p>
	                        </div>
	                    </div>
	                </div>
	            </main>
	        </div>
	    </div>
	</div>
	</html>