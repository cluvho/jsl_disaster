<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layout}">
<head>
<meta charset="UTF-8">
<title>コミュニティー</title> 

<style>
.pagination {
	list-style: none;
	padding-left: 0;
	margin: 0;
}

.header-actions {
	display: flex;
	justify-content: space-between;
	align-items: center;
	gap: 20px;
	margin-top: 10px;
}

.search-bar {
	display: flex;
	align-items: center;
	gap: 8px;
}

.search-bar input, .search-bar select {
	padding: 6px 10px;
	border: 1px solid #ccc;
	border-radius: 6px;
}

/* ✅✅✅ 검색어 입력창의 너비를 늘리는 스타일을 추가했습니다. ✅✅✅ */
.search-bar input.form-control {
    flex-grow: 1;      /* 입력창이 남은 공간을 모두 차지하도록 설정 */
    min-width: 100px;  /* 최소 너비를 지정하여 너무 좁아지지 않게 함 */
}

/* 검색 버튼이 찌그러지지 않도록 스타일을 추가 */
.search-bar button {
    flex-shrink: 0;      /* 버튼 너비가 줄어들지 않도록 설정 */
    white-space: nowrap; /* 버튼 안의 텍스트가 줄바꿈되지 않도록 설정 */
}

.write-btn {
	display: inline-block;
	padding: 8px 14px; /* 버튼 크기 통일을 위해 padding 조정 */
	background-color: #007bff;
	color: white;
	text-decoration: none;
	border-radius: 6px;
	transition: background-color 0.2s;
	border: none; /* button 태그의 기본 테두리 제거 */
    cursor: pointer; /* button 태그에 마우스 포인터 적용 */
    font-size: 1rem; /* 폰트 크기 일관성 유지 */
    line-height: 1.5; /* 라인 높이 일관성 유지 */
    text-align: center; /* 텍스트 중앙 정렬 */
    white-space: nowrap; /* 텍스트 줄바꿈 방지 */
}


.write-btn:hover {
	background-color: #0056b3;
}


.post-card {
	display: block;
	padding: 15px;
	margin-bottom: 12px;
	border: 1px solid #ddd;
	border-radius: 8px;
	text-decoration: none;
	color: inherit;
	transition: box-shadow 0.2s;
}

.post-card:hover {
	box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.post-meta {
	font-size: 0.9rem;
	color: #555;
	margin-bottom: 6px;
}

.post-title {
	font-size: 1.1rem;
	font-weight: 600;
	margin-bottom: 6px;
}

.post-summary {
	font-size: 0.95rem;
	color: #333;
}

.post-summary img {
	display: none;
}

.text-center {
	margin-top: 20px;
}

.post-thumb {
	width: 80px;
	height: 80px;
	object-fit: cover;
	border-radius: 6px;
	border: 2px solid #ddd;
	margin-right: 12px;
}
</style>
</head>
<body>
	<div layout:fragment="content">
		<div class="page-community container mt-4">

			<div class="community-header mb-3">
				<h2 class="community-title" data-ko="커뮤니티">コミュニティー</h2>

				<div class="header-actions">
					<!-- ✅✅✅ 검색창에 select 드롭다운을 추가 ✅✅✅ -->
					<form th:action="@{/community/main}" method="get"
						class="search-bar">
						<select name="searchType" class="form-control"
							style="width: 120px;">
							<option value="all" th:selected="${searchType == 'all'}" data-ko="전체">全体</option>
							<option value="title" th:selected="${searchType == 'title'}" data-ko="제목/내용">タイトル・内容</option>
							<option value="nickname"
								th:selected="${searchType == 'nickname'}" data-ko="작성자">作成者</option>
							<option value="disasterType"
								th:selected="${searchType == 'disasterType'}" data-ko="재해종류">災害タイプ</option>
						</select>
						<input type="text" name="keyword" class="form-control"
							placeholder="検索語入力" th:value="${keyword}" data-ko="검색어 입력">
							
						<div class="region-search">		
							<button onclick="searchRegion()">🔍 <span data-translate="search_btn" data-ko="검색">検索</span></button>
						</div>
					
					</form>

					<div>
						<a th:href="@{/community/communityWrite}" class="write-btn" data-ko="글작성">作成</a>
					</div>
							
				</div>
			</div>

			<div class="post-list">
				<div th:each="post : ${postList}">
					
						<a th:href="@{/community/{postId}(postId=${post.postId})}" class="post-card d-flex">

						<div class="post-content ms-3">
							<div class="post-meta">
								<span
									th:text="${post.disasterType != null ? post.disasterType.displayName : '기타'}">재난
									유형</span> <span>|</span> <span th:text="'作成者 : ' + ${post.nickname}" data-ko="작성자">작성자</span>
								<span>|</span> <span th:text="'照会数 : ' + ${post.viewCount}" data-ko="조회수">조회수</span>
								<span>|</span> <span
									th:text="${#temporals.format(post.createdAt, 'yyyy-MM-dd HH:mm')}">작성일</span>
							</div>

							<h4 class="post-title" th:text="${post.title}">제목</h4>
							<p class="post-summary" th:text="${post.summary}">내용</p>

						</div>
					</a>
				</div>
			</div>


			<div class="text-center">
				<nav aria-label="Page navigation" th:if="${totalPages > 0}">
					<ul class="pagination">
						<!--  페이지네이션 링크에 검색 조건을 추가하여 유지되도록 수정 -->
						<li class="page-item"
							th:classappend="${currentPage == 1} ? 'disabled'"><a
							class="page-link"
							th:href="@{/community/main(page=${currentPage - 1}, searchType=${searchType}, keyword=${keyword})}"
							aria-label="Previous"> <span aria-hidden="true">&laquo;</span>
						</a></li>

						<li class="page-item"
							th:each="pageNumber : ${#numbers.sequence(1, totalPages)}"
							th:classappend="${pageNumber == currentPage} ? 'active'"><a
							class="page-link"
							th:href="@{/community/main(page=${pageNumber}, searchType=${searchType}, keyword=${keyword})}"
							th:text="${pageNumber}"></a></li>

						<li class="page-item"
							th:classappend="${currentPage == totalPages} ? 'disabled'">
							<a class="page-link"
							th:href="@{/community/main(page=${currentPage + 1}, searchType=${searchType}, keyword=${keyword})}"
							aria-label="Next"> <span aria-hidden="true">&raquo;</span>
						</a>
						</li>		
					</ul>
				</nav>
			</div>

		</div>
	</div>
</body>
</html>

